(function($){if(!ko.utils.arrayCopy){ko.utils.arrayCopy=function(array){return array.slice(0)}}if(!ko.utils.arraySort){ko.utils.arraySort=function(array,compare){var copy=array.slice(0);copy.sort(compare);return copy}}if(!ko.utils.valuesAreRecursivelyEqual){ko.utils.valuesAreRecursivelyEqual=function(a,b){var typeofa,typeofb,i,len,key;if(a===b)return true;typeofa=a===null?"null":typeof(a=a?a.valueOf():a);typeofb=b===null?"null":typeof(b=b?b.valueOf():b);if(typeofa!==typeofb)return false;switch(typeofa){case"string":case"boolean":case"number":case"functon":case"undefined":case"null":return a===b}typeofa={}.toString.call(a);typeofb={}.toString.call(b);if(typeofa===typeofb){if(typeofa==="[object Array]"){if(a.length!==b.length)return false;len=a.length;for(i=0;i<len;i++){if(!ko.utils.valuesAreRecursivelyEqual(a[i],b[i]))return false}}else{for(key in a){if(!(key in b))return false;if(!ko.utils.valuesAreRecursivelyEqual(a[key],b[key]))return false}}}else{return false}return true}}ko.extenders.format=function(target,formatter){return ko.computed(function(){return formatter(target())})};ko.bindingHandlers.init={init:function(element,valueAccessor,allBindingsAccessor,viewModel){var init=ko.unwrap(valueAccessor());if(typeof init=="function"){init.call(element,viewModel)}}};ko.virtualElements.allowedBindings["init"]=true;ko.bindingHandlers.jquery={init:function(element,valueAccessor){var plugin=ko.unwrap(valueAccessor());$(element)[plugin]()}};ko.bindingHandlers.accordion={init:function(element,valueAccessor){$(element).accordion(ko.unwrap(valueAccessor())||{})}};(function(){function options(valueAccessor){var value=valueAccessor();if(ko.isObservable(value)){value={disabled:false,value:value}}return{disabled:ko.unwrap(value.disabled),value:ko.unwrap(value.value)}}ko.bindingHandlers.progressbar={init:function(element,valueAccessor){$(element).progressbar(options(valueAccessor))},update:function(element,valueAccessor){$(element).progressbar("option",options(valueAccessor))}}})();ko.bindingHandlers.fade={init:function(element,valueAccessor){ko.unwrap(valueAccessor())?$(element).show():$(element).hide()},update:function(element,valueAccessor){ko.unwrap(valueAccessor())?$(element).fadeIn():$(element).fadeOut()}};ko.bindingHandlers.fadeIn={init:ko.bindingHandlers.fade.init,update:function(element,valueAccessor){ko.unwrap(valueAccessor())?$(element).fadeIn():$(element).hide()}};ko.bindingHandlers.slideDown={init:ko.bindingHandlers.fade.init,update:function(element,valueAccessor){ko.unwrap(valueAccessor())?$(element).slideDown():$(element).hide()}};ko.bindingHandlers.slideDownUp={init:ko.bindingHandlers.fade.init,update:function(element,valueAccessor){ko.unwrap(valueAccessor())?$(element).slideDown():$(element).slideUp()}};ko.bindingHandlers.sortable={init:function(element,valueAccessor,allBindingsAccessor){var $list=$(element);var config=valueAccessor();if(!config)return;var allBindings=allBindingsAccessor();var array=allBindings.foreach||allBindings.template.foreach;$list.data("ko-sort-array",array).sortable(config).bind("sortstart",function(event,ui){var item=ui.item;item.data("ko-sort-array",array);item.data("ko-sort-index",item.index())}).bind("sortupdate",function(event,ui){var item=ui.item;var $newList=item.parent();if($newList[0]!=$list[0])return;var oldArray=item.data("ko-sort-array");var oldIndex=item.data("ko-sort-index");var newArray=$newList.data("ko-sort-array");var newIndex=item.index();var cut=oldArray.splice(oldIndex,1)[0];newArray.splice(newIndex,0,cut)})}};ko.bindingHandlers.fileupload={init:function(element,valueAccessor){var options=ko.unwrap(valueAccessor());if(!options.dataType)options.dataType="JSON";$(element).fileupload(options)}};ko.bindingHandlers.autocomplete={init:function(element,valueAccessor){var options=ko.unwrap(valueAccessor());if(typeof options=="string"){options={source:options}}if(typeof options!="object"){return}if(!$.isNumeric(options["delay"])){var local=$.isArray(options["source"]);options["delay"]=local?0:250}$(element).autocomplete(options)}};if($.timeago){$.timeago.settings.allowFuture=true;ko.utils.extend($.timeago.settings.strings,{minute:"a minute",hour:"an hour",hours:"%d hours",day:"a day",days:"%d days",month:"a month",months:"%d months",year:"a year"});ko.bindingHandlers.timeago={init:function(element){$(element).addClass("timeago")},update:function(element,valueAccessor){var $this=$(element);var value=ko.unwrap(valueAccessor());if(value==null){return}if(typeof value==="number"){value=new Date(value)}if(value instanceof Date){$this.attr("title",value.toString());if($this.data("timeago")){$this.data("timeago",{datetime:value});$this.text($.timeago.inWords(value))}else{$this.data("timeago",{datetime:value});$this.timeago()}}}}}if($.fn.textext){ko.bindingHandlers.textext={init:function(element,valueAccessor,allBindingsAccessor){var $this=$(element);var options=allBindingsAccessor()["textextOptions"]||{};var plugins=["tags"];if($this.attr("placeholder")!=undefined){plugins.push("prompt")}if(options.ajax){plugins.push("autocomplete","ajax");if(!options.ajax.dataType){options.ajax.dataType="json"}}$.extend(options,{plugins:plugins,extTags:{setTags:function(data){if(!data)return;$(this.tagElements()).remove();this.addTags(data)}}});$this.textext(options).on({setFormData:function(event,data){var value=valueAccessor();value(data)}})},update:function(element,valueAccessor){var list=ko.unwrap(valueAccessor())||[];var $textext=$(element).textext();$textext[0].tags().setTags(list)}}}if($.fn.select2){ko.bindingHandlers.select2={init:function(element,valueAccessor,allBindingsAccessor){var obj=valueAccessor(),allBindings=allBindingsAccessor(),lookupKey=allBindings.lookupKey;$(element).select2(obj);if(lookupKey){var value=ko.unwrap(allBindings.value);$(element).select2("data",ko.utils.arrayFirst(obj.data.results,function(item){return item[lookupKey]===value}))}ko.utils.domNodeDisposal.addDisposeCallback(element,function(){$(element).select2("destroy")})},update:function(element){$(element).trigger("change")}}}ko.bindingHandlers.post={update:function(element,valueAccessor,allBindingsAccessor){var $this=$(element);var post=ko.unwrap(valueAccessor());var content=post.content();if(content==null){return}var mimeType=post.mimeType();if(mimeType=="text/plain"){$this.addClass("_prewrap")}else{$this.removeClass("_prewrap")}if(mimeType=="text/plain"){$this.text(content);return}if(mimeType=="text/html"){$this.html(content);return}if(mimeType!="text/x-markdown"){$this.html("<!-- Error: Unsupported mime type "+mimeType+" -->");return}var markdown=$this.data("markdown");if(!markdown){var options=allBindingsAccessor()["postMarkdown"]||{};markdown=new Kaggle.Markdown.Converter(options);$this.data("markdown",markdown)}markdown.width=element.clientWidth;$this.html(markdown.makeHtml(content));if(markdown.math){if(typeof window.MathJax!="undefined"){window.MathJax.Hub.Queue(["Typeset",window.MathJax.Hub,element])}}}}})(jQuery);(function(){Kaggle.Url.blobContainer=function(name){return Kaggle.Constant.blobService+name};Kaggle.Url.loginReturnUrl=function(returnUrl){return"/account/login?ReturnUrl="+escape(returnUrl)};Kaggle.Url.replaceMetaContent="/admin/replace-meta-content";Kaggle.Url.Rest={Attributes:"/knockout/attributes",Competitions:"/knockout/competitions",Countries:"/knockout/countries",Languages:"/knockout/languages",Forums:"/knockout/forums",Profiles:"/knockout/profiles",SiteStatistics:"/knockout/site-statistics",TimeZones:"/knockout/time-zones",TimeZoneContinents:"/knockout/time-zones/continents",UserAttributes:"/knockout/user-attributes"};Kaggle.Url.mvcDotNetWorkaroundRestGetUrl=function(entity){return entity.restUrl()+"/"+entity.id};Kaggle.Url.mvcDotNetWorkaroundRestPostUrl=function(entity){return entity.restUrl()+"/POST"};Kaggle.Url.mvcDotNetWorkaroundRestPutUrl=function(entity){return entity.restGetUrl()+"/PUT"};Kaggle.Url.mvcDotNetWorkaroundRestDeleteUrl=function(entity){return entity.restGetUrl()+"/DELETE"};Kaggle.Url.fetchProspector=function(competitionId){return Kaggle.Url.Rest.Competitions+"/"+competitionId+"/prospector"};Kaggle.Url.updateProspector=function(competitionId){return Kaggle.Url.Rest.Competitions+"/"+competitionId+"/prospector/PUT"};Kaggle.Url.fetchProspect=function(competitionId,prospectId){return Kaggle.Url.Rest.Competitions+"/"+competitionId+"/prospect/"+prospectId};Kaggle.Url.createProspectDraft=function(competitionId,prospectId){return Kaggle.Url.Rest.Competitions+"/"+competitionId+"/prospect/"+prospectId+"/draft"};Kaggle.Url.createProspectComment=function(competitionId,prospectId){return Kaggle.Url.Rest.Competitions+"/"+competitionId+"/prospect/"+prospectId+"/comment"};Kaggle.Url.createProspectVote=function(competitionId,prospectId){return Kaggle.Url.Rest.Competitions+"/"+competitionId+"/prospect/"+prospectId+"/vote"};Kaggle.Url.createProspectVideo=function(competitionId,prospectId){return Kaggle.Url.Rest.Competitions+"/"+competitionId+"/prospect/"+prospectId+"/video"};Kaggle.Url.saveProspectSlideOrder=function(competitionId,prospectId){return Kaggle.Url.Rest.Competitions+"/"+competitionId+"/prospect/"+prospectId+"/slides"};Kaggle.Url.deleteProspectFile=function(competitionId,prospectId,fileId){return Kaggle.Url.Rest.Competitions+"/"+competitionId+"/prospect/"+prospectId+"/file/"+fileId};Kaggle.Url.thumbnailProspectSlide=function(competitionId,prospectId,prospectFile,width,height){if(prospectFile.isImage()){return Kaggle.Url.thumbnailProspectImage(competitionId,prospectId,prospectFile.id,width,height)}if(prospectFile.isVideo()){return prospectFile.video().thumbnailSrc()}return null};Kaggle.Url.thumbnailProspectImage=function(competitionId,prospectId,fileId,width,height){var url=Kaggle.Url.Rest.Competitions+"/"+competitionId+"/prospect/"+prospectId+"/image/"+fileId;if(width){url=url+"?width="+width;if(height){url=url+"&height="+height}}return url};Kaggle.Url.profileView=function(profile){return profile.url()};Kaggle.Url.profileResults=function(profile){return profile.url()+"/results"};Kaggle.Url.profileScripts=function(profile){return profile.url()+"/scripts"};Kaggle.Url.profileForum=function(profile){return profile.url()+"/forum"};Kaggle.Url.profileMessage=function(profile){return profile.url()+"/message"};Kaggle.Url.profileAccount=function(profile){return profile.url()+"/account"};Kaggle.Url.profileEdit=function(profile){return profile.url()+"/edit"};Kaggle.Url.profileActivity=function(profile){return profile.url()+"/activity"};Kaggle.Url.profileHunnerdbux=function(profile){return profile.url()+"/hunnerdbux"};Kaggle.Url.profileRestDisplay=function(profile){return profile.restGetUrl()+"/display"};Kaggle.Url.profileRestLegal=function(profile){return profile.restGetUrl()+"/legal"};Kaggle.Url.profileRestEmail=function(profile){return profile.restGetUrl()+"/email"};Kaggle.Url.profileRestBirthday=function(profile){return profile.restGetUrl()+"/birthday"};Kaggle.Url.competitionUrl=function(competition){return window.location.protocol+"//"+competition.site().hostName()+"/c/"+competition.name()};Kaggle.Url.competitionLogo=function(competition){return Kaggle.Url.competitionFile(competition,"logos/front_page.png")};Kaggle.Url.competitionThumbnail=function(competition){return Kaggle.Url.competitionFile(competition,"logos/thumb76_76.png")};Kaggle.Url.competitionFile=function(competition,filePath){var site=competition.site();if(!site)return null;return[Kaggle.Url.blobContainer("competitions"),competition.site().shortName(),competition.id,filePath].join("/")};Kaggle.Url.competitionTeam=function(competition){return Kaggle.Url.competitionUrl(competition)+"/team"};Kaggle.Url.teamPath=function(team){return"/t/"+team.id+"/"+team.slug()};Kaggle.Url.teamMakeLeader=function(team,user){return Kaggle.Url.teamPath(team)+"/leader/"+user.id};Kaggle.Url.teamSaveSettings=function(team){return Kaggle.Url.teamPath(team)+"/settings"};Kaggle.Url.teamInvite=function(team){return Kaggle.Url.teamPath(team)+"/invite"};Kaggle.Url.teamUninvite=function(team){return Kaggle.Url.teamPath(team)+"/uninvite"};Kaggle.Url.prospectEdit=function(prospect){return prospect.url()+"/edit"};Kaggle.Url.prospectPublish=function(prospect){return prospect.url()+"/publish"};Kaggle.Url.prospectSave=function(prospect){return prospect.url()+"/save"};Kaggle.Url.prospectRetract=function(prospect){return prospect.url()+"/retract"};Kaggle.Url.prospectDelete=function(prospect){return prospect.url()+"/delete"};Kaggle.Url.forumRedirectUrl=function(forum){return"/forums/f/"+forum.id};Kaggle.Url.forumTopicRedirectUrl=function(forumTopic){return"/forums/t/"+forumTopic.id};Kaggle.Url.forumMessageRedirectUrl=function(forumMessage){var forumTopic=forumMessage.forumTopic();if(!forumTopic)return null;return forumTopic.redirectUrl()+"/p/"+forumMessage.id}})();(function($){Kaggle.Format={};Kaggle.Format.text2css=function(text){if(text==null)return null;return $.trim(text.replace(/[^\w\s]+/,"")).replace(/\s+/g,"-").toLowerCase()};Kaggle.Format.inflectIntegerNo=function(number,single,plural){if(number==null)return null;if(typeof number=="string")number=parseInt(number,10);if(typeof number!="number"||isNaN(number))return"";if(number===0)return"No "+plural;if(number===1)return number+" "+single;return number+" "+plural};var unit=["byte","bytes","KB","MB","GB"];var toRounded=function(number){if(number<10){return number.toFixed(2)}if(number<100){return number.toFixed(1)}return number.toFixed(0)};Kaggle.Format.fileSize=function(bytes){if(typeof bytes=="string"){bytes=parseInt(bytes,10)}if(typeof bytes!="number"||isNaN(bytes)){return""}if(bytes===0)return"0 "+unit[0];if(bytes==1)return"1 "+unit[0];if(bytes<1024)return bytes+" "+unit[1];if(bytes<1048576)return toRounded(bytes/1024)+" "+unit[2];if(bytes<1073741824)return toRounded(bytes/1048576)+" "+unit[3];return toRounded(bytes/1073741824)+" "+unit[4]}})(jQuery);(function($){Kaggle.Page.tabs=function(initial){return ko.utils.extend(ko.observable(initial),{cache:{},show:function(name,element){return function(){history.replaceState({},"",$(element).attr("href"));this(name);return false}.bind(this)},showing:function(name){if(!this.cache[name]){this.cache[name]=ko.computed(function(){return this()==name},this)}return this.cache[name]}})};Kaggle.Page.partial=function(url){if(!Kaggle.Page.partial[url]){var html=ko.observable();var loaded=ko.observable(false);var loading=ko.observable(false);var computed=ko.computed({read:function(){if(loaded())return html();if(loading())return null;loading(true);$.get(url,function(data){html(data);loaded(true);loading(false)});return null},deferEvaluation:true});computed.html=html;computed.loaded=loaded;computed.loading=loading;Kaggle.Page.partial[url]=computed}return Kaggle.Page.partial[url]}})(jQuery);(function($){with(Kaggle.Model){Kaggle.Model.extend=ko.utils.extend;Kaggle.Model.subclass=function(superclass,constructor){constructor.prototype=new superclass;constructor.prototype.constructor=constructor;return constructor};Kaggle.Model.reportAjaxError=function(object){if(object.hasOwnProperty("message")){object.toString=function(){return this.method+" "+this.url}}throw new Error(object)};Kaggle.Model.entity=function(type,options){var entity=subclass(Entity,function(){Entity.apply(this,arguments)});Kaggle.Model[type]=entity;entity.type=type;entity.initialize=[];if(!options.meta)options.meta={};if(options.mixin){if(typeof options.mixin=="object"){for(var i in options.mixin){var mixin=options.mixin[i];mixin.call(mixin,entity,options)}}delete options.mixin}if(options.meta){entity.meta=new Meta(options.meta);delete options.meta}if(options.initialize){entity.initialize.push(options.initialize);delete options.intialize}for(var method in options){if(typeof options[method]!="function")continue;entity.prototype[method]=options[method]}};Kaggle.Model.trackType=function(type){Kaggle.Model.trackEntity(Kaggle.Model[type])};Kaggle.Model.trackEntity=function(entity){entity.initialize.push(function(){Kaggle.Model.trackObject(this)})};Kaggle.Model.trackObject=function(object){var meta=object.constructor.meta;var track=[];for(var name in meta){if(meta[name]instanceof Kaggle.Model.Property){track.push(name)}if(meta[name]instanceof Kaggle.Model.List){track.push(name)}}for(var i in track){var property=object[track[i]];property.original=ko.observable(property.peek());property.original.equalityComparer=property.equalityComparer;property.changed=ko.computed({read:function(){if(this.loaded&&!this.loaded())return false;return!this.equalityComparer(this(),this.original())},owner:property,deferEvaluation:true})}var reverse=track.slice(0).reverse();object.changed=ko.computed({read:function(){for(i in reverse){if(this[track[i]].changed())return true}return false},owner:object,deferEvaluation:true});object.changed.commit=function(){for(i in track){property=object[track[i]];property.original(property.peek())}};object.changed.rollback=function(){for(i in track){property=object[track[i]];property(property.original.peek())}}};Kaggle.Model.Entity=function(proto){if(!proto)proto={id:null};this.id=proto.id;var meta=this.constructor.meta;for(var name in meta){meta[name].initialize(this);meta[name].set(this,proto)}for(var i in this.constructor.initialize){this.constructor.initialize[i].apply(this,arguments)}};Kaggle.Model.Entity.prototype.set=function(proto){var meta=this.constructor.meta;for(var name in meta){meta[name].set(this,proto)}return true};Kaggle.Model.Entity.prototype.formData=function(){var meta=this.constructor.meta;var form={};for(var name in meta){if(meta[name]instanceof Property){var value=this[name].peek();if(value!=null)form[name]=value}if(meta[name]instanceof List){form[name]=this[name].peek()||[]}}return form};Kaggle.Model.Meta=function(members){for(var name in members){this[name]=members[name];this[name].name=name}};Kaggle.Model.Member=function(){};Kaggle.Model.Internal=subclass(Member,function(){if(arguments.length){this["default"]=arguments[0]}});Kaggle.Model.Internal.prototype.initialize=function(entity){entity[this.name]=ko.observable(this["default"])};Kaggle.Model.Internal.prototype.set=function(){};Kaggle.Model.Property=subclass(Member,function(){if(arguments.length){this["default"]=arguments[0]}});Kaggle.Model.Property.prototype.initialize=function(entity){entity[this.name]=ko.observable(this["default"])};Kaggle.Model.Property.prototype.set=function(entity,proto){var name=this.name;if(proto.hasOwnProperty(name)){entity[name](proto[name])}};Kaggle.Model.List=subclass(Member,function(){if(arguments.length){this["default"]=arguments[0]}});Kaggle.Model.List.prototype.initialize=function(entity){entity[this.name]=ko.observableArray(this["default"]);entity[this.name].equalityComparer=ko.utils.valuesAreRecursivelyEqual};Kaggle.Model.List.prototype.set=function(entity,proto){var name=this.name;if(proto.hasOwnProperty(name)){entity[name](proto[name])}};Kaggle.Model.Computed=subclass(Member,function(code,options){this.code=code;this.options=options||{};if(!this.options.hasOwnProperty("deferEvaluation")){this.options.deferEvaluation=true}});Kaggle.Model.Computed.prototype.initialize=function(entity,options){var merged=extend(options||{},this.options);entity[this.name]=ko.computed(this.code,entity,merged)};Kaggle.Model.Computed.prototype.set=function(){};Kaggle.Model.Reference=subclass(Member,function(type,options){if(typeof type=="function"){this.type=type}else{this.typeName=type}this.options=options||{}});Kaggle.Model.Reference.prototype.initialize=function(entity){if(!this.type){this.type=Kaggle.Model[this.typeName];if(!this.type){throw new Error("Failed to bind "+this.name+" to non-existant entity type "+this.typeName)}}var name=this.name;var options=this.options;var member=ko.observable();entity[name]=member;entity[name].meta=this;entity[name].id=ko.observable();entity[name+"Id"]=ko.observable();var rest=options.Rest;if(rest){if(typeof rest=="boolean"){if(!this.typeCache){this.typeCache=Kaggle.Model[this.typeName+"Cache"];if(!this.typeCache){throw new Error("Failed to bind "+this.name+" to non-cached entity type "+this.typeName)}}member.loading=ko.computed(function(){var target=this();return target?target.loading():false},member);member.loaded=ko.computed(function(){var target=this();return target?target.loaded():false},member);member.load=ko.computed({read:function(){if(this.peek())return this().load();var target=member.meta.typeCache.get(this.id());var result=target.load();this(target);return result},owner:member,deferEvaluation:true});member.refresh=function(){if(member.peek())return member.refresh();var target=member.meta.typeCache.get(this.id());return target.refresh()}}else{member.loading=ko.observable(false);member.loaded=ko.observable(false);member.load=ko.computed({read:function(){if(!entity.restUrl())return this.loaded();if(!this.loaded())return this.refresh();return this.peek()},owner:member,deferEvaluation:true});member.refresh=function(){if(entity.restUrl()&&!member.loading.peek()){member.loading(true);var url=member.restUrl();$.ajax({type:"GET",url:url,dataType:"json",context:member,error:function(request,status){this.loading(false);Kaggle.Model.reportAjaxError({message:"Kaggle JSON API call failed",status:status,method:"GET",url:url})},success:function(child){this.loading(false);var proto={};proto[name]=child;this.meta.set(entity,proto);this.loaded(true);return}})}return member.loaded.peek()};member.save=function(success){if(entity.restUrl()&&!this.loaded.peek())return;var url=this.restUrl()+"/PUT";var child=this.peek();$.ajax({type:"POST",url:url,dataType:"json",data:child.formData(),traditional:true,context:this,error:function(request,status){Kaggle.Model.reportAjaxError({message:"Kaggle JSON API call failed",status:status,method:"POST",url:url})},success:function(proto){if(proto.id&&!child.id){child.id=proto.id;this.id(proto.id)}if(typeof proto=="object")child.set(proto);if(child.changed)child.changed.commit();if(typeof success=="function")success(entity,proto)}})};if(typeof this.restUrl=="function"){member.restUrl=this.restUrl}else{member.restUrl=function(){return entity.restGetUrl()+"/"+options.Rest}}}}};Kaggle.Model.Reference.prototype.set=function(entity,proto){var name=this.name;var nameId=name+"Id";var member=entity[name];if(proto.hasOwnProperty(nameId)){var id=proto[nameId];if(member.id.peek()!=id){member(null)}member.id(id);entity[nameId](id)}if(proto.hasOwnProperty(name)){var value=proto[name];var child=member.peek();if(child){child.set(value);if(child.id&&child.id!=member.id.peek()){member.id(child.id)}}else if(typeof value=="object"){var type=this.type;child=new type(value);member(child);member.id(child.id)}else if(!value){member(null);member.id(null)}}};Kaggle.Model.Collection=subclass(Member,function(type,options){if(typeof type=="function"){this.type=type}else{this.typeName=type}this.options=options||{}});Kaggle.Model.Collection.nameRegexp=/^(.+)List$/;Kaggle.Model.Collection.prototype.initialize=function(entity){if(!this.type){this.type=Kaggle.Model[this.typeName];if(!this.type){throw new Error("Failed to bind "+this.name+" to entity type "+this.typeName)}}var name=this.name;var root=this.root();var options=this.options;var member=ko.observableArray();entity[name]=member;entity[name].meta=this;if(options.Count){entity[root+"Count"]=ko.computed({read:function(){return this[name]().length},owner:entity,deferEvaluation:true})}if(options.Order){var order=options.Order;entity[root+"Order"]=ko.computed({read:function(){return ko.utils.arraySort(this[name](),order)},owner:entity,deferEvaluation:true})}if(options.IdList){entity[root+"IdList"]=function(){return ko.utils.arrayMap(this[name].peek(),function(child){return child.id})}}if(options.Rest){member.loading=ko.observable(false);member.loaded=ko.observable(false);member.count=ko.computed(function(){return this.loaded()?this.length:null},member);member.load=ko.computed({read:function(){if(!entity.id)return this.loaded();if(!this.loaded())return this.refresh();return this.peek()},owner:member,deferEvaluation:true});member.refresh=function(){if(entity.id&&!this.loading.peek()){this.loading(true);var url=this.restUrl();$.ajax({type:"GET",url:url,dataType:"json",context:this,error:function(request,status){Kaggle.Model.reportAjaxError({message:"Kaggle JSON API call failed",status:status,method:"GET",url:url});member.loading(false)},success:function(list){member.loading(false);var data={};data[name]=list;this.meta.set(entity,data);member.loaded(true)}})}return this.loaded.peek()};if(typeof this.restUrl=="function"){member.restUrl=this.restUrl}else{member.restUrl=function(){return entity.restGetUrl()+"/"+options.Rest}}}};Kaggle.Model.Collection.prototype.set=function(entity,proto){var name=this.name;var value=proto[name];var member=entity[name];if(!$.isArray(value))return;if(value.length){var peek=member.peek();if(this.equals(peek,value)){for(var i in peek){peek[i].set(value[i])}}else{var oldOrder=this.hash(peek);var newOrder=this.hash(value);member.valueHasMutated();for(i in peek){var id=peek[i].id;if(newOrder.hasOwnProperty(id)){peek[i].set(value[newOrder[id]])}else{peek.splice(i,1)}}for(i in value){id=value[i].id;if(oldOrder.hasOwnProperty(id))continue;var type=this.type;var object=new type(value[i]);peek.push(object)}peek.sort(function(a,b){return newOrder[a.id]-newOrder[b.id]});member.valueHasMutated()}}else if(member.peek().length>0){member.removeAll()}if(member.loaded){member.loaded(true)}};Kaggle.Model.Collection.prototype.root=function(){var name=this.name;if(name==null)return null;var match=Collection.nameRegexp.exec(name);return match?match[1]:name};Kaggle.Model.Collection.prototype.equals=function(a,b){if(a.length!=b.length)return false;for(var i in a){if(a[i].id!=b[i].id)return false}return true};Kaggle.Model.Collection.prototype.hash=function(list){var hash={};for(var i in list){hash[list[i].id]=i}return hash};Kaggle.Model.SiteMixin=function(type,options){options.meta.siteId=new Property;type.prototype.site=function(){return SiteCache.get(this.siteId())}};Kaggle.Model.UserMixin=function(type,options){options.meta.userId=new Property;options.meta.profile=new Computed(function(){return Kaggle.Model.ProfileCache.load(this.userId())})};Kaggle.Model.RestMixin=function(type,options){type.prototype.refresh=function(){if(this.id&&!this.loading.peek()){this.loading(true);this.restGet(function(loaded){loaded.loading(false);loaded.loaded(true)})}return this.loaded.peek()};options.meta.loading=new Internal;options.meta.loaded=new Internal;options.meta.load=new Computed(function(){if(!this.id)return this.loaded()?this:false;if(!this.loaded())return this.refresh();return this});type.prototype.restGet=function(success){var url=this.restGetUrl();$.ajax({type:"GET",url:url,dataType:"json",context:this,error:function(request,status){Kaggle.Model.reportAjaxError({message:"Kaggle JSON API call failed",status:status,method:"GET",url:url})},success:function(proto){this.set(proto);if(this.changed)this.changed.commit();if(typeof success=="function")success(this,proto);return}});return};type.prototype.restGetUrl=function(){return Kaggle.Url.mvcDotNetWorkaroundRestGetUrl(this)};type.prototype.restPost=function(success){var url=this.restPostUrl();var data=this.restPostData();$.ajax({type:"POST",url:url,data:data,traditional:true,dataType:"json",context:this,error:function(request,status){Kaggle.Model.reportAjaxError({message:"Kaggle JSON API call failed",status:status,method:"POST",url:url})},success:function(proto){if(this.id==null&&proto.id)this.id=proto.id;if(typeof proto=="object")this.set(proto);if(this.changed)this.changed.commit();if(typeof success=="function")success(this,proto);return}});return};type.prototype.restPostUrl=function(){return Kaggle.Url.mvcDotNetWorkaroundRestPostUrl(this)};type.prototype.restPostData=function(){return this.formData()};type.prototype.restPut=function(success){var url=this.restPutUrl();var data=this.restPutData();$.ajax({type:"POST",url:url,data:data,traditional:true,dataType:"json",context:this,error:function(request,status){Kaggle.Model.reportAjaxError({message:"Kaggle JSON API call failed",status:status,method:"POST",url:url})},success:function(proto){if(typeof proto=="object")this.set(proto);if(this.changed)this.changed.commit();if(typeof success=="function")success(this,proto);return}});return};type.prototype.restPutUrl=function(){return Kaggle.Url.mvcDotNetWorkaroundRestPutUrl(this)};type.prototype.restPutData=function(){return this.formData()};type.prototype.restDelete=function(success){var url=this.restDeleteUrl();$.ajax({type:"POST",url:url,dataType:"json",context:this,error:function(request,status){Kaggle.Model.reportAjaxError({message:"Kaggle JSON API call failed",status:status,method:"POST",url:url})},success:function(proto){if(typeof proto=="object")this.set(proto);if(this.changed)this.changed.commit();if(typeof success=="function")success(this,proto);return}})};type.prototype.restDeleteUrl=function(){return Kaggle.Url.mvcDotNetWorkaroundRestDeleteUrl(this)};type.prototype.partial=function(name){return Kaggle.Page.partial(this.restGetUrl()+"/partial/"+name)};type.cache={load:function(id){var object=this.get(id);return object?object.load():object},get:function(id){if(id==null)return null;if(typeof this[id]!="object"){this[id]=new type({id:id})}return this[id]},peek:function(id){if(id==null)return null;return this[id]},set:function(proto){if(proto instanceof Object&&proto.id!=null){var id=proto.id;if(!this[id]){return this[id]=new type(proto)}this[id].set(proto);return this[id]}return null}};Kaggle.Model[type.type+"Cache"]=type.cache};Kaggle.Model.AllMixin=function(type){var all=ko.observableArray([]);all.loading=ko.observable(false);all.loaded=ko.observable(false);all.load=ko.computed({read:function(){if(!type.prototype.restUrl())return this.loaded();if(!this.loaded())return this.refresh();return this.peek()},owner:all,deferEvaluation:true});all.refresh=function(){if(all.loading.peek()){return all.loaded.peek()}all.loading(true);var url=type.prototype.restUrl();$.ajax({type:"GET",url:url,dataType:"json",context:all,error:function(request,status){Kaggle.Model.reportAjaxError({message:"Kaggle JSON API call failed",status:status,method:"GET",url:url});all.loading(false)},success:function(list){this.loading(false);this.valueWillMutate();this([]);var peek=this.peek();var cache=type.cache;for(var i in list){peek.push(cache?cache.set(list[i]):new type(list[i]))}this.valueHasMutated();this.loaded(true)}});return all.loaded.peek()};type.All=all}}})(jQuery);
//# sourceMappingURL=kaggle.knockout.min.js.map